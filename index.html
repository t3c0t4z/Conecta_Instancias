<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>tzCI++</title>

  <!-- Favicons - M√∫ltiplos tamanhos -->
  <link rel="icon" type="image/png" sizes="16x16" href="https://lhujzzoqebgjbsnezmrt.supabase.co/storage/v1/object/public/Photos/AppIcons_t3c0t4z_pr_rx_br.png"/>
  <link rel="icon" type="image/png" sizes="32x32" href="https://lhujzzoqebgjbsnezmrt.supabase.co/storage/v1/object/public/Photos/AppIcons_t3c0t4z_pr_rx_br.png"/>
  <link rel="icon" type="image/png" sizes="180x180" href="https://lhujzzoqebgjbsnezmrt.supabase.co/storage/v1/object/public/Photos/AppIcons_t3c0t4z_pr_rx_br.png"/>
  <link rel="apple-touch-icon" sizes="180x180" href="https://lhujzzoqebgjbsnezmrt.supabase.co/storage/v1/object/public/Photos/AppIcons_t3c0t4z_pr_rx_br.png"/>

  <!-- SEO -->
  <meta name="description" content="t3c0t4z - Sistema de Conex√£o Segura para WhatsApp. Conecte seu n√∫mero ao sistema de automa√ß√£o inteligente via QR Code. Automa√ß√£o, intelig√™ncia e conex√£o em uma plataforma."/>
  <meta name="keywords" content="t3c0t4z, WhatsApp, automa√ß√£o, QR Code, conex√£o segura, sistema inteligente, bot, automa√ß√£o de mensagens"/>
  <meta name="author" content="t3c0t4z"/>
  <meta name="robots" content="index, follow"/>

  <!-- Open Graph -->
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://t3c0t4z.com/"/>
  <meta property="og:title" content="t3c0t4z - Sistema de Conex√£o Segura"/>
  <meta property="og:description" content="Conecte seu WhatsApp ao sistema de automa√ß√£o inteligente via QR Code. Plataforma segura e confi√°vel para automa√ß√£o de mensagens."/>
  <meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwMCIgaGVpZ2h0PSI2MzAiIHZpZXdCb3g9IjAgMCAxMjAwIDYzMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjEyMDAiIGhlaWdodD0iNjMwIiBmaWxsPSIjMTAwQTI0Ii8+CjxyZWN0IHg9IjUwIiB5PSI1MCIgd2lkdGg9IjExMDAiIGhlaWdodD0iNTMwIiByeD0iMjAiIGZpbGw9IiMxQTIyNDIiLz4KPHRleHQgeD0iNjAwIiB5PSIyMDAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSI0OCIiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjQTc4QkZBIj50M2MwdDR6PC90ZXh0Pjwvc3ZnPg=="/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>
  <meta property="og:site_name" content="t3c0t4z"/>

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image"/>
  <meta property="twitter:url" content="https://t3c0t4z.com/"/>
  <meta property="twitter:title" content="t3c0t4z - Sistema de Conex√£o Segura"/>
  <meta property="twitter:description" content="Conecte seu WhatsApp ao sistema de automa√ß√£o inteligente via QR Code. Plataforma segura e confi√°vel para automa√ß√£o de mensagens."/>
  <meta property="twitter:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwMCIgaGVpZ2h0PSI2MzAiIHZpZXdCb3g9IjAgMCAxMjAwIDYzMCIgZmlsbD0ibm9uZSIgeG1zbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjEyMDAiIGhlaWdodD0iNjMwIiBmaWxsPSIjMTAwQTI0Ii8+CjxyZWN0IHg9IjUwIiB5PSI1MCIgd2lkdGg9IjExMDAiIGhlaWdodD0iNTMwIiByeD0iMjAiIGZpbGw9IiMxQTIyNDIiLz4KPHRleHQgeD0iNjAwIiB5PSIyMDAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSI0OCIiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjQTc4QkZBIj50M2MwdDR6PC90ZXh0Pjwvc3ZnPg=="/>

  <!-- PWA / Tema -->
  <meta name="theme-color" content="#6d28d9"/>
  <meta name="msapplication-TileColor" content="#6d28d9"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="apple-mobile-web-app-title" content="t3c0t4z"/>
  <link rel="canonical" href="https://t3c0t4z.com/">
  <link rel="manifest" href="manifest.json">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap');

    /* =========================
       PALETA ELITE PREMIUM +++
       ========================= */
    :root{
      /* Fundo roxo profundo com nuances azuladas */
      --bg-primary:#0b0714;   /* tela */
      --bg-secondary:#0f0a1a; /* painel transl√∫cido */
      --bg-tertiary:#130e22;  /* inputs/barras */
      --bg-elevated:#19102c;  /* bot√µes/hover */

      /* Tipografia */
      --text-primary:#f8f7ff;
      --text-secondary:#c9c3ff;
      --text-muted:#8b86a6;

      /* Acentos neon (roxos + ciano) */
      --text-accent:#a78bfa;      /* roxo 400 */
      --text-accent-2:#22d3ee;    /* ciano claro */
      --text-accent-3:#f472b6;    /* rosa */

      /* Bordas + estados */
      --border-primary:#2a1f3d;
      --border-secondary:#3a2a5c;
      --border-accent:#a78bfa;

      --status-success:#10b981; /* verde sucesso */
      --status-warning:#f59e0b;
      --status-error:#ef4444;
      --status-info:#e5e7eb;

      /* Sombras e brilhos */
      --shadow-sm:0 2px 8px rgba(0,0,0,.35);
      --shadow-md:0 10px 40px rgba(0,0,0,.45);
      --shadow-lg:0 20px 100px rgba(0,0,0,.55);
      --shadow-glow:0 0 32px rgba(167,139,250,.35);

      /* Espa√ßos e raios */
      --spacing-xs:.5rem;
      --spacing-sm:1rem;
      --spacing-md:1.5rem;
      --spacing-lg:2rem;
      --spacing-xl:3rem;
      --spacing-2xl:4rem;

      --radius-sm:12px;
      --radius-md:16px;
      --radius-lg:20px;
      --radius-xl:28px;
      --radius-2xl:36px;

      --transition-fast:.18s ease;
      --transition-normal:.3s ease;
      --transition-slow:.55s ease;
    }

    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:'Inter',sans-serif;
      background: radial-gradient(1200px 700px at 15% 10%, rgba(109,40,217,.18), transparent 50%),
                  radial-gradient(900px 600px at 85% 85%, rgba(34,211,238,.14), transparent 55%),
                  radial-gradient(1000px 600px at 60% 40%, rgba(244,114,182,.12), transparent 60%),
                  var(--bg-primary);
      color:var(--text-primary);
      line-height:1.6;min-height:100vh;overflow-x:hidden;position:relative;
    }

    /* Aurora espacial premium */
    body::before{
      content:'';
      position:fixed;inset:0;pointer-events:none;z-index:-3;
      background:
        radial-gradient(60% 120% at 50% -20%, rgba(109,40,217,.28) 0%, transparent 60%),
        radial-gradient(40% 60% at 110% 10%, rgba(34,211,238,.18) 0%, transparent 60%),
        radial-gradient(30% 50% at -10% 110%, rgba(244,114,182,.15) 0%, transparent 60%);
      filter: blur(40px);
      animation: auroraFloat 20s ease-in-out infinite alternate;
    }
    @keyframes auroraFloat{
      from{transform: translateY(-2%)}
      to{transform: translateY(2%)}
    }

    /* Grade sutil em neon */
    .circuit-grid{
      position:fixed;inset:0;z-index:-4;opacity:.25;
      background-image:
        linear-gradient(rgba(167,139,250,.06) 1px, transparent 1px),
        linear-gradient(90deg, rgba(34,211,238,.05) 1px, transparent 1px);
      background-size:60px 60px;
      animation:gridMove 38s linear infinite;
      mask-image: radial-gradient(80% 80% at 50% 30%, #000 40%, transparent 100%);
    }
    @keyframes gridMove{0%{transform:translate(0,0)}100%{transform:translate(60px,60px)}}

    /* Efeitos de part√≠culas e ondas (reajustados ao tema roxo) */
    .particles,.energy-waves,.hexagons,.energy-rays,.interference,.energy-pulses,.distortion,.glitch-overlay,.magnetic-field,.matrix-rain,.scan-lines,.circuit-lines,.floating-elements{
      position:fixed;inset:0;pointer-events:none;z-index:-2;
    }

    .particle{position:absolute;width:2px;height:2px;background:var(--text-accent);border-radius:50%;animation:particleFloat 15s linear infinite;opacity:.8}
    .particle:nth-child(1){top:10%;left:15%;animation-delay:0s}
    .particle:nth-child(2){top:25%;right:20%;animation-delay:3s}
    .particle:nth-child(3){bottom:30%;left:25%;animation-delay:6s}
    .particle:nth-child(4){bottom:15%;right:30%;animation-delay:9s}
    .particle:nth-child(5){top:60%;left:10%;animation-delay:12s}
    .particle:nth-child(6){top:45%;right:15%;animation-delay:15s}
    @keyframes particleFloat{
      0%{transform:translate(0,0);opacity:0}
      25%{opacity:.8}
      50%{transform:translate(40px,-90px);opacity:1}
      75%{opacity:.75}
      100%{transform:translate(80px,-180px);opacity:0}
    }

    .energy-wave{position:absolute;width:100%;height:2px;background:linear-gradient(90deg, transparent, var(--text-accent), transparent);opacity:0;animation:energyWave 8s ease-in-out infinite}
    .energy-wave:nth-child(1){top:22%;animation-delay:0s}
    .energy-wave:nth-child(2){top:50%;animation-delay:2s}
    .energy-wave:nth-child(3){top:78%;animation-delay:4s}
    @keyframes energyWave{0%{transform:scaleX(0);opacity:0}50%{transform:scaleX(1);opacity:.6}100%{transform:scaleX(0);opacity:0}}

    .hexagon{position:absolute;width:46px;height:26px;border:1px solid rgba(167,139,250,.14);clip-path:polygon(50% 0%,100% 25%,100% 75%,50% 100%,0% 75%,0% 25%);animation:hexagonFloat 20s ease-in-out infinite}
    .hexagon:nth-child(1){top:18%;left:9%;animation-delay:0s}
    .hexagon:nth-child(2){top:38%;right:13%;animation-delay:5s}
    .hexagon:nth-child(3){bottom:28%;left:18%;animation-delay:10s}
    .hexagon:nth-child(4){bottom:18%;right:24%;animation-delay:15s}
    @keyframes hexagonFloat{0%,100%{transform:translateY(0) rotate(0);opacity:.12}50%{transform:translateY(-28px) rotate(180deg);opacity:.32}}

    .energy-ray{position:absolute;width:1px;height:0;background:linear-gradient(to bottom, transparent, var(--text-accent-2), transparent);animation:energyRay 12s ease-in-out infinite}
    .energy-ray:nth-child(1){top:0;left:20%;animation-delay:0s;transform:rotate(45deg)}
    .energy-ray:nth-child(2){top:0;right:30%;animation-delay:3s;transform:rotate(-30deg)}
    .energy-ray:nth-child(3){bottom:0;left:40%;animation-delay:6s;transform:rotate(60deg)}
    .energy-ray:nth-child(4){bottom:0;right:20%;animation-delay:9s;transform:rotate(-45deg)}
    @keyframes energyRay{0%{height:0;opacity:0}50%{height:100vh;opacity:.35}100%{height:0;opacity:0}}

    .interference-line{position:absolute;width:100%;height:1px;background:linear-gradient(90deg, transparent, rgba(167,139,250,.25), transparent);animation:interferenceMove 6s ease-in-out infinite}
    .interference-line:nth-child(1){top:30%;animation-delay:0s}
    .interference-line:nth-child(2){top:60%;animation-delay:2s}
    .interference-line:nth-child(3){top:90%;animation-delay:4s}
    @keyframes interferenceMove{0%,100%{transform:translateX(-100%) scaleX(0);opacity:0}50%{transform:translateX(0) scaleX(1);opacity:.25}}

    .energy-pulse{position:absolute;width:110px;height:110px;border:1px solid var(--text-accent-3);border-radius:50%;animation:energyPulse 10s ease-in-out infinite}
    .energy-pulse:nth-child(1){top:24%;left:14%;animation-delay:0s}
    .energy-pulse:nth-child(2){top:64%;right:18%;animation-delay:5s}
    @keyframes energyPulse{0%{transform:scale(0);opacity:.8}100%{transform:scale(3);opacity:0}}

    .distortion-wave{position:absolute;inset:0;background:
      radial-gradient(circle at 30% 30%, rgba(167,139,250,.08) 0%, transparent 55%),
      radial-gradient(circle at 70% 70%, rgba(34,211,238,.08) 0%, transparent 55%);
      animation:distortionFloat 40s ease-in-out infinite}
    @keyframes distortionFloat{0%,100%{transform:translate(0,0) scale(1);opacity:.04}50%{transform:translate(20px,-18px) scale(1.06);opacity:.08}}

    .glitch-overlay{opacity:0;animation:glitchOverlay 15s ease-in-out infinite}
    .glitch-overlay::before{
      content:'';position:absolute;inset:0;
      background:
        linear-gradient(90deg, transparent 49%, rgba(167,139,250,.16) 50%, transparent 51%),
        linear-gradient(0deg, transparent 49%, rgba(244,114,182,.09) 50%, transparent 51%);
      background-size:4px 4px;animation:glitchScan .1s ease-in-out infinite
    }
    @keyframes glitchOverlay{0%,90%,100%{opacity:0}95%{opacity:.25}}
    @keyframes glitchScan{0%,100%{transform:translateX(0)}50%{transform:translateX(2px)}}

    .magnetic-line{position:absolute;width:2px;height:100%;background:linear-gradient(to bottom, transparent, var(--text-accent), transparent);animation:magneticFlow 25s ease-in-out infinite}
    .magnetic-line:nth-child(1){left:24%;animation-delay:0s}
    .magnetic-line:nth-child(2){left:50%;animation-delay:8s}
    .magnetic-line:nth-child(3){left:76%;animation-delay:16s}
    @keyframes magneticFlow{0%,100%{transform:scaleY(.35);opacity:.02}50%{transform:scaleY(1);opacity:.06}}

    /* Palavras flutuantes */
    .automation-words{z-index:-1}
    .automation-word{
      position:absolute;font-family:'JetBrains Mono',monospace;font-size:14px;font-weight:600;
      color:var(--text-accent);opacity:.08;transform:rotate3d(1,1,0,15deg);
      animation:wordFloat 20s ease-in-out infinite;text-shadow:0 0 12px rgba(167,139,250,.35);
      white-space:nowrap;user-select:none;letter-spacing:.06em
    }
    .automation-word.special{
      opacity:.45;font-weight:800;font-size:18px;color:#c4b5fd; /* roxo claro */
      text-shadow:0 0 22px rgba(167,139,250,.85),0 0 36px rgba(167,139,250,.45);
      animation:specialWordFloat 16s ease-in-out infinite;letter-spacing:.12em
    }
    .automation-word.special:hover{
      opacity:.85!important;transform:rotate3d(1,1,0,15deg) scale(1.12)!important;
      text-shadow:0 0 30px rgba(167,139,250,1),0 0 44px rgba(167,139,250,.65)!important;
      transition:all .3s ease;color:#e9d5ff!important
    }
    @keyframes specialWordFloat{
      0%,100%{transform:rotate3d(1,1,0,15deg) translateY(0) translateX(0);opacity:.45}
      25%{transform:rotate3d(1,1,0,20deg) translateY(-28px) translateX(18px);opacity:.55}
      50%{transform:rotate3d(1,1,0,10deg) translateY(-56px) translateX(-22px);opacity:.65}
      75%{transform:rotate3d(1,1,0,24deg) translateY(-28px) translateX(28px);opacity:.55}
    }
    /* posi√ß√µes */
    .automation-word:nth-child(1){top:20%;left:15%;animation-delay:0s;animation-duration:20s}
    .automation-word:nth-child(2){top:30%;right:20%;animation-delay:2s;animation-duration:22s}
    .automation-word:nth-child(3){top:45%;left:20%;animation-delay:6s;animation-duration:22s}
    .automation-word:nth-child(4){top:55%;right:25%;animation-delay:9s;animation-duration:30s}
    .automation-word:nth-child(5){top:75%;left:15%;animation-delay:12s;animation-duration:26s}
    .automation-word:nth-child(6){top:35%;left:60%;animation-delay:15s;animation-duration:24s}
    .automation-word:nth-child(7){top:65%;right:10%;animation-delay:18s;animation-duration:27s}
    .automation-word:nth-child(8){top:85%;right:35%;animation-delay:21s;animation-duration:29s}
    .automation-word:nth-child(9){top:5%;left:50%;animation-delay:24s;animation-duration:23s}
    .automation-word:nth-child(10){top:95%;left:40%;animation-delay:27s;animation-duration:25s}
    .automation-word:nth-child(11){top:15%;left:70%;animation-delay:30s;animation-duration:26s}
    .automation-word:nth-child(12){top:40%;left:80%;animation-delay:33s;animation-duration:28s}
    .automation-word:nth-child(13){top:60%;left:70%;animation-delay:36s;animation-duration:24s}
    .automation-word:nth-child(14){top:80%;left:60%;animation-delay:39s;animation-duration:27s}
    .automation-word:nth-child(15){top:10%;right:20%;animation-delay:42s;animation-duration:25s}
    @keyframes wordFloat{
      0%,100%{transform:rotate3d(1,1,0,15deg) translate(0,0);opacity:.08}
      25%{transform:rotate3d(1,1,0,20deg) translate(10px,-20px);opacity:.12}
      50%{transform:rotate3d(1,1,0,10deg) translate(-15px,-40px);opacity:.16}
      75%{transform:rotate3d(1,1,0,24deg) translate(20px,-20px);opacity:.12}
    }
    .automation-word.highlight{animation:wordHighlight 8s ease-in-out infinite}
    @keyframes wordHighlight{
      0%,80%,100%{opacity:.08;transform:rotate3d(1,1,0,15deg) scale(1);text-shadow:0 0 12px rgba(167,139,250,.35)}
      90%{opacity:.28;transform:rotate3d(1,1,0,15deg) scale(1.14);text-shadow:0 0 24px rgba(167,139,250,.6)}
    }

    /* Chuva Matrix (em roxo) */
    .matrix-rain{z-index:-3;opacity:.08}
    .matrix-column{position:absolute;top:-100%;color:#c4b5fd;font-family:'JetBrains Mono',monospace;font-size:14px;line-height:1;animation:matrixFall 8s linear infinite;filter:drop-shadow(0 0 6px rgba(167,139,250,.45))}
    @keyframes matrixFall{0%{transform:translateY(-100vh)}100%{transform:translateY(100vh)}}

    /* Scan lines */
    .scan-line{position:absolute;width:100%;height:2px;background:linear-gradient(90deg, transparent, rgba(167,139,250,.25), transparent);animation:scanMove 4s linear infinite}
    .scan-line:nth-child(1){top:20%;animation-delay:0s}
    .scan-line:nth-child(2){top:40%;animation-delay:1s}
    .scan-line:nth-child(3){top:60%;animation-delay:2s}
    .scan-line:nth-child(4){top:80%;animation-delay:3s}
    @keyframes scanMove{0%{transform:translateX(-100%);opacity:0}50%{opacity:1}100%{transform:translateX(100%);opacity:0}}

    .binary-counter{position:fixed;top:22px;right:24px;font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--text-muted);opacity:.4;z-index:1;animation:binaryPulse 2s ease-in-out infinite}
    @keyframes binaryPulse{0%,100%{opacity:.35}50%{opacity:.7}}

    /* =========
       CONTAINER
       =========
       - Agora mais COMPRIDO/ALONGADO e menos "caixa"
    */
    .container{
      width:min(860px,92vw); /* mais comprido */
      margin: clamp(1.2rem, 3vw, 2.2rem) auto clamp(2rem, 4vw, 3rem);
      background: linear-gradient(180deg, rgba(25,16,44,.72), rgba(19,14,34,.72));
      border:1px solid rgba(167,139,250,.18);
      border-radius: var(--radius-2xl);
      padding: clamp(1.25rem, 3vw, 2.25rem) clamp(1rem, 3vw, 2rem);
      box-shadow: var(--shadow-lg), var(--shadow-glow);
      backdrop-filter: blur(12px);
      position:relative;overflow:hidden;
    }
    /* Borda din√¢mica neon */
    .container::before{
      content:'';position:absolute;inset:-1px;border-radius:inherit;z-index:-1;opacity:.55;
      background:
        conic-gradient(from 180deg at 50% 50%,
          rgba(167,139,250,.55),
          rgba(34,211,238,.35),
          rgba(244,114,182,.35),
          rgba(167,139,250,.55));
      filter: blur(18px);
      mask: linear-gradient(#000,#000) content-box, linear-gradient(#000,#000);
      -webkit-mask-composite: xor; mask-composite: exclude;
      padding:2px;
      animation: borderGlow 12s linear infinite;
    }
    @keyframes borderGlow{to{transform:rotate(360deg)}}

    .header{text-align:center;margin-bottom:var(--spacing-xl);position:relative}
    .logo-container{margin-bottom:var(--spacing-md);position:relative}

    /* LOGO ‚Äì largura fixa 220px e centralizada */
    .logo{position:relative;width:220px;margin:0 auto;animation:logoGlitch 10s ease-in-out infinite}
    .logo img{display:block;width:220px;height:auto;margin:0 auto;filter:drop-shadow(0 10px 26px rgba(167,139,250,.25))}
    /* glitch com a SUA logomarca (exatamente centralizado) */
    .logo::before,.logo::after{
      content:"";position:absolute;inset:0;opacity:0;
      background:url("https://dildpbhnplvynguniwzs.supabase.co/storage/v1/object/public/produtos/logomarca%20para%20n8n%20wbc5.png") center/contain no-repeat;
    }
    @keyframes logoGlitch{0%,90%,100%{transform:translate(0)}91%{transform:translate(-2px,2px)}92%{transform:translate(2px,-2px)}93%{transform:translate(-2px,-2px)}94%{transform:translate(2px,2px)}}
    .logo::before{animation:glitchBefore 10s ease-in-out infinite;z-index:-1}
    .logo::after{animation:glitchAfter 10s ease-in-out infinite;z-index:-2}
    @keyframes glitchBefore{0%,90%,100%{opacity:0;transform:translate(0)}91%{opacity:.85;transform:translate(-1px,1px)}92%{opacity:.85;transform:translate(1px,-1px)}93%{opacity:.85;transform:translate(-1px,-1px)}94%{opacity:.85;transform:translate(1px,1px)}}
    @keyframes glitchAfter{0%,90%,100%{opacity:0;transform:translate(0)}91%{opacity:.6;transform:translate(1px,-1px)}92%{opacity:.6;transform:translate(-1px,1px)}93%{opacity:.6;transform:translate(1px,1px)}94%{opacity:.6;transform:translate(-1px,-1px)}}

    .logo-subtitle{
      font-size:.9rem;color:var(--text-secondary);opacity:.85;font-family:'JetBrains Mono',monospace;
      letter-spacing:.14em;margin-top:.6rem;text-transform:uppercase
    }

    .title{
      font-size: clamp(1.45rem, 2.1vw, 1.9rem);
      font-weight:700;color:var(--text-primary);margin:.6rem 0 var(--spacing-xs);
      letter-spacing:.02em;white-space:nowrap;overflow:hidden;border-right:2px solid var(--text-accent);
      animation: typing 2.8s steps(42,end), blink-caret .8s step-end infinite;
      text-shadow:0 0 14px rgba(167,139,250,.35)
    }
    .subtitle{color:var(--text-secondary);opacity:.9;font-size:1rem;font-weight:400;margin-bottom:var(--spacing-lg)}

    @keyframes typing{from{width:0}to{width:100%}}
    @keyframes blink-caret{from,to{border-color:transparent}50%{border-color:var(--text-accent)}}

    /* Barra de status alongada */
    .status-bar{
      display:flex;align-items:center;justify-content:center;gap:var(--spacing-sm);
      margin:0 auto var(--spacing-lg);padding: 1rem clamp(.8rem, 2.5vw, 1.25rem);
      background: linear-gradient(180deg, rgba(27,19,49,.75), rgba(22,16,40,.75));
      border:1px solid var(--border-secondary);border-radius: var(--radius-lg);
      font-size:.95rem;color:#e9d5ff;font-family:'JetBrains Mono',monospace;font-weight:600;letter-spacing:.06em;
      box-shadow: inset 0 0 0 1px rgba(167,139,250,.08);
      position:relative;overflow:hidden;max-width: 700px;
    }
    .status-bar::before{
      content:'';position:absolute;inset:0;background:linear-gradient(90deg, transparent, rgba(167,139,250,.16), transparent);
      animation:terminalScan 3s ease-in-out infinite
    }
    @keyframes terminalScan{0%{left:-100%}50%{left:100%}100%{left:100%}}
    .status-indicator{width:10px;height:10px;background:var(--text-accent);border-radius:50%;animation:statusPulse 2s infinite;box-shadow:0 0 0 0 rgba(167,139,250,.6)}
    @keyframes statusPulse{0%{transform:scale(1)}50%{transform:scale(1.25)}100%{transform:scale(1)}}
    .status-text{display:flex;flex-direction:column;gap:2px}
    .status-line-1{font-size:.92rem;color:#c4b5fd}
    .status-line-2{font-size:.82rem;color:#fff;opacity:.95}

    /* Formul√°rio */
    .form-group{margin-bottom:var(--spacing-md);text-align:left}
    .form-label{
      display:block;font-size:.9rem;font-weight:600;color:#e9d5ff;opacity:.95;margin-bottom:.55rem;
      font-family:'Inter',sans-serif;text-transform:uppercase;letter-spacing:.08em
    }
    .form-input{
      width:100%;padding:1rem .95rem;background:rgba(24,18,42,.65);
      border:1px solid rgba(167,139,250,.18);border-radius: var(--radius-md);
      color:var(--text-primary);font-size:1rem;font-family:'Inter',sans-serif;outline:none;
      transition: var(--transition-normal);
      box-shadow: inset 0 0 0 1px rgba(167,139,250,.05);
    }
    .form-input::placeholder{color:var(--text-muted)}
    .form-input:focus{
      border-color: var(--border-accent);
      background: rgba(28,20,52,.9);
      box-shadow: 0 0 0 4px rgba(167,139,250,.14), var(--shadow-glow);
      animation: inputGlitch .28s ease-in-out;
    }
    @keyframes inputGlitch{0%,100%{transform:translateX(0)}25%{transform:translateX(-1px)}75%{transform:translateX(1px)}}

    .form-help{margin-top:.55rem;font-size:.82rem;color:#d9d6ff;opacity:.85;font-family:'Inter',sans-serif;display:flex;align-items:center;gap:.45rem}
    .form-help-icon{opacity:.95;font-size:1rem}
    .error-message{
      margin-top:.6rem;padding:.75rem;background: rgba(239,68,68,.08);
      border:1px solid rgba(239,68,68,.28);border-radius: var(--radius-sm);color:#fecaca;
      font-size:.9rem;font-family:'Inter',sans-serif;display:none
    }

    .btn{
      background: linear-gradient(180deg, rgba(34,21,61,1), rgba(28,18,52,1));
      color:#f5f3ff;border:1px solid rgba(167,139,250,.25);
      padding:1rem 1.25rem;border-radius: var(--radius-xl);
      font-size:1rem;font-weight:800;font-family:'Inter',sans-serif;cursor:pointer;
      transition: var(--transition-normal);text-transform:uppercase;letter-spacing:.08em;width:100%;
      position:relative;overflow:hidden;box-shadow: inset 0 0 0 1px rgba(167,139,250,.06), var(--shadow-md
    }
    .btn::before{
      content:'';position:absolute;top:0;left:-120%;width:120%;height:100%;
      background:linear-gradient(90deg, transparent, rgba(167,139,250,.18), transparent);
      transition:left .6s
    }
    .btn:hover{
      transform:translateY(-2px) scale(1.01);
      border-color: var(--border-accent);
      box-shadow: 0 0 24px rgba(167,139,250,.28), var(--shadow-glow)
    }
    .btn:hover::before{left:100%}
    .btn:active{transform:translateY(0) scale(.999)}
    .btn:disabled{background:rgba(30,22,54,.9);color:var(--text-muted);cursor:not-allowed;border-color:rgba(167,139,250,.18);transform:none}

    .btn-primary{
      background: linear-gradient(180deg, #7c3aed, #5b21b6);
      border-color:#a78bfa;color:#fdfcff;
      text-shadow: 0 0 16px rgba(167,139,250,.45);
    }
    .btn-primary:hover{
      background:linear-gradient(180deg, #8b5cf6, #6d28d9);
      box-shadow:0 0 26px rgba(167,139,250,.36), var(--shadow-glow)
    }

    .loader{
      width:44px;height:44px;border:2px solid rgba(167,139,250,.25);
      border-top:2px solid var(--text-accent);border-radius:50%;animation:spin 1s linear infinite;
      margin: var(--spacing-lg) auto;display:none;position:relative
    }
    .loader::before{
      content:'';position:absolute;top:8px;left:8px;width:26px;height:26px;border:2px solid rgba(167,139,250,.2);
      border-bottom:2px solid var(--text-accent-2);border-radius:50%;animation:spin .85s linear infinite reverse
    }
    .loader::after{content:'';position:absolute;top:16px;left:16px;width:8px;height:8px;background: var(--text-accent-3);border-radius:50%;animation:pulse 1.5s ease-in-out infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    @keyframes pulse{0%,100%{transform:scale(1);opacity:1}50%{transform:scale(1.22);opacity:.75}}

    #qrcode{margin-top:var(--spacing-md);display:flex;justify-content:center;align-items:center}
    #qrcode img{
      border-radius: var(--radius-xl);box-shadow: 0 14px 44px rgba(0,0,0,.55), 0 0 24px rgba(167,139,250,.25);
      border:2px solid rgba(167,139,250,.35);max-width:100%;height:auto;transition: var(--transition-normal)
    }
    #qrcode img:hover{transform:scale(1.02);box-shadow:0 24px 70px rgba(0,0,0,.6), 0 0 36px rgba(167,139,250,.38)}

    #timer{
      margin-top: var(--spacing-md);font-weight:700;font-size:.95rem;color:#e9d5ff;
      background: linear-gradient(180deg, rgba(27,19,49,.85), rgba(22,16,40,.85));
      padding: .9rem 1rem;border-radius: var(--radius-lg);border:1px solid rgba(167,139,250,.18);
      font-family:'JetBrains Mono',monospace;text-align:center;letter-spacing:.08em;
      box-shadow: inset 0 0 0 1px rgba(167,139,250,.06)
    }

    .status-message{
      padding: var(--spacing-lg);border-radius: var(--radius-xl);margin-bottom: var(--spacing-lg);
      text-align:center;font-family:'Inter',sans-serif;background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.14);color:var(--status-info)
    }
    .status-message.success{background: rgba(16,185,129,.12);border-color: rgba(16,185,129,.3);color:#d1fae5}
    .status-message.info{background: rgba(167,139,250,.1);border-color: rgba(167,139,250,.28);color:#e9d5ff}
    .status-message.warning{background: rgba(245,158,11,.12);border-color: rgba(245,158,11,.35);color:#ffedd5}
    .status-message.error{background: rgba(239,68,68,.12);border-color: rgba(239,68,68,.35);color:#ffe4e6}

    /* Linhas e elementos avulsos */
    .circuit-line{position:absolute;background:var(--text-accent);animation:circuitFlow 6s ease-in-out infinite}
    .circuit-line.horizontal{height:1px;width:0;animation:circuitFlowHorizontal 6s ease-in-out infinite}
    .circuit-line.vertical{width:1px;height:0;animation:circuitFlowVertical 6s ease-in-out infinite}
    .circuit-line:nth-child(1){top:30%;left:10%;animation-delay:0s}
    .circuit-line:nth-child(2){top:70%;right:15%;animation-delay:2s}
    .circuit-line:nth-child(3){bottom:20%;left:20%;animation-delay:4s}
    @keyframes circuitFlowHorizontal{0%{width:0;opacity:0}50%{width:220px;opacity:1}100%{width:0;opacity:0}}
    @keyframes circuitFlowVertical{0%{height:0;opacity:0}50%{height:160px;opacity:1}100%{height:0;opacity:0}}

    .data-stream{position:fixed;top:50%;right:28px;transform:translateY(-50%);font-family:'JetBrains Mono',monospace;font-size:10px;color:#c4b5fd;opacity:.25;z-index:1;animation:dataFlow 3s linear infinite}
    @keyframes dataFlow{0%{transform:translate(-8px,-50%);opacity:0}50%{opacity:1}100%{transform:translate(-28px,-50%);opacity:0}}

    /* Responsivo */
    @media (max-width: 1024px){
      .container{width:min(800px,94vw)}
      .status-bar{max-width: 650px}
    }
    @media (max-width: 768px){
      .container{width:calc(100% - 1.5rem);margin:1rem auto 1.6rem;padding:1.25rem;border-radius: var(--radius-xl)}
      .title{font-size:1.3rem}
      .btn{padding:.95rem 1rem}
    }
    @media (max-width: 480px){
      .container{width:calc(100% - 1rem);margin:.75rem auto 1.2rem;padding:1rem;border-radius: var(--radius-lg)}
      .title{font-size:1.15rem}
      .btn{padding:.85rem 1rem;font-size:.95rem}
    }
  </style>
</head>
<body>
  <!-- Camadas decorativas -->
  <div class="circuit-grid"></div>
  <div class="matrix-rain" id="matrixRain"></div>
  <div class="scan-lines">
    <div class="scan-line"></div><div class="scan-line"></div><div class="scan-line"></div><div class="scan-line"></div>
  </div>
  <div class="particles">
    <div class="particle"></div><div class="particle"></div><div class="particle"></div>
    <div class="particle"></div><div class="particle"></div><div class="particle"></div>
  </div>
  <div class="energy-waves">
    <div class="energy-wave"></div><div class="energy-wave"></div><div class="energy-wave"></div>
  </div>
  <div class="hexagons">
    <div class="hexagon"></div><div class="hexagon"></div><div class="hexagon"></div><div class="hexagon"></div>
  </div>
  <div class="energy-rays">
    <div class="energy-ray"></div><div class="energy-ray"></div><div class="energy-ray"></div><div class="energy-ray"></div>
  </div>
  <div class="interference">
    <div class="interference-line"></div><div class="interference-line"></div><div class="interference-line"></div>
  </div>
  <div class="energy-pulses">
    <div class="energy-pulse"></div><div class="energy-pulse"></div>
  </div>
  <div class="distortion"><div class="distortion-wave"></div></div>
  <div class="glitch-overlay"></div>
  <div class="magnetic-field">
    <div class="magnetic-line"></div><div class="magnetic-line"></div><div class="magnetic-line"></div>
  </div>
  <div class="automation-words">
    <div class="automation-word special">SkSk100</div>
    <div class="automation-word special">M41C0 17010</div>
    <div class="automation-word">AUTOMA√á√ÉO</div>
    <div class="automation-word">INTELIG√äNCIA</div>
    <div class="automation-word">ALGORITMO</div>
    <div class="automation-word">SISTEMA</div>
    <div class="automation-word">PROCESSO</div>
    <div class="automation-word">FLUXO</div>
    <div class="automation-word">INTEGRA√á√ÉO</div>
    <div class="automation-word">CONEX√ÉO</div>
    <div class="automation-word">DADOS</div>
    <div class="automation-word">API</div>
    <div class="automation-word">WEBHOOK</div>
    <div class="automation-word">BOT</div>
    <div class="automation-word">CHAT</div>
    <div class="automation-word">QR CODE</div>
    <div class="automation-word">WHATSAPP</div>
  </div>
  <div class="circuit-lines">
    <div class="circuit-line horizontal"></div>
    <div class="circuit-line vertical"></div>
    <div class="circuit-line horizontal"></div>
  </div>
  <div class="binary-counter" id="binaryCounter">10101010</div>
  <div class="data-stream" id="dataStream">DATA_FLOW</div>

  <!-- CONTAINER (alongado) -->
  <div class="container">
    <div class="header">
      <div class="logo-container">
        <div class="logo">
          <img src="https://dildpbhnplvynguniwzs.supabase.co/storage/v1/object/public/produtos/logomarca%20para%20n8n%20wbc5.png"
               alt="t3c0t4z Logo" style="max-width:220px;height:auto;display:block;margin:0 auto;" />
        </div>
        <div class="logo-subtitle">SISTEMA DE CONEX√ÉO SEGURA</div>
      </div>
      <h1 class="title">Inicializar Agente WhatsApp</h1>
      <p class="subtitle">Conecte seu n√∫mero ao sistema de automa√ß√£o<br/>inteligente via QR Code</p>
    </div>

    <div class="status-bar">
      <div class="status-indicator"></div>
      <div class="status-text">
        <div class="status-line-1">SISTEMA OPERACIONAL</div>
        <div class="status-line-2">AGUARDANDO IDENTIFICA√á√ÉO</div>
      </div>
    </div>

    <div class="form-group">
      <label class="form-label" for="instanceName">Identificador da Inst√¢ncia</label>
      <input type="text" id="instanceName" class="form-input" placeholder="ex: Pessoal_Clinica ou Clinica_Bianca"/>
      <div class="form-help">
        <span class="form-help-icon">‚ö†Ô∏è</span>
        Use apenas letras, n√∫meros e underscore(_). Evite espa√ßos e caracteres especiais.
      </div>
      <div id="errorMessage" class="error-message"></div>
    </div>

    <button class="btn btn-primary" id="generateButton" onclick="generateQRCode()">GERAR QR CODE</button>

    <div id="loader" class="loader"></div>
    <div id="qrcode"></div>
    <div id="timer"></div>
  </div>

  <script src="config.js"></script>
  <script>
    // Adiciona o registro do Service Worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js').then(registration => {
          console.log('ServiceWorker registration successful with scope: ', registration.scope);
        }, err => {
          console.log('ServiceWorker registration failed: ', err);
        });
      });
    }
    /* ======== FUN√á√ïES ORIGINAIS (intactas) ======== */

    function createMatrixRain(){
      const matrixContainer=document.getElementById('matrixRain');
      const columns=20;
      const characters='01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥';
      for(let i=0;i<columns;i++){
        const column=document.createElement('div');
        column.className='matrix-column';
        column.style.left=(i*5)+'%';
        column.style.animationDelay=(Math.random()*8)+'s';
        let columnText='';
        for(let j=0;j<20;j++){columnText+=characters[Math.floor(Math.random()*characters.length)]+'<br>';}
        column.innerHTML=columnText;
        matrixContainer.appendChild(column);
      }
    }

    function updateBinaryCounter(){
      const el=document.getElementById('binaryCounter');
      let b='';for(let i=0;i<8;i++){b+=Math.random()>0.5?'1':'0';}
      el.textContent=b;
    }

    function updateHexCounter(){
      const el=document.getElementById('hexCounter');
      const hex=Math.floor(Math.random()*65536).toString(16).toUpperCase().padStart(4,'0');
      el && (el.textContent='0x'+hex);
    }

    function updateDataStream(){
      const el=document.getElementById('dataStream');
      const types=['DATA_FLOW','PACKET_01','STREAM_02','BYTE_03','HEX_04'];
      el.textContent=types[Math.floor(Math.random()*types.length)];
    }

    function initProgrammingAnimations(){
      createMatrixRain();
      setInterval(updateBinaryCounter,1000);
      setInterval(updateHexCounter,2000);
      setInterval(updateDataStream,3000);
      initWordHighlights();
    }

    function initWordHighlights(){
      const words=document.querySelectorAll('.automation-word');
      setInterval(()=>{
        const r=words[Math.floor(Math.random()*words.length)];
        r.classList.add('highlight');
        setTimeout(()=>r.classList.remove('highlight'),8000);
      },12000);
      setInterval(()=>{
        let i=0;
        const seq=setInterval(()=>{
          if(i<words.length){
            words[i].classList.add('highlight');
            setTimeout(()=>words[i].classList.remove('highlight'),2000);
            i++;
          }else{clearInterval(seq)}
        },500);
      },30000);
    }

    let timerInterval,connectionCheckInterval,timeLeft=30,currentInstanceName='',isConnected=false;

    document.addEventListener('DOMContentLoaded',function(){
      const instanceInput=document.getElementById('instanceName');
      initProgrammingAnimations();
      instanceInput.addEventListener('input',function(){
        hideError();
        const v=this.value;
        if(v && !isValidInstanceName(v)){
          if(v.includes(' ')){
            const s=formatInstanceName(v);
            showError(`Espa√ßos detectados. Sugest√£o: "${s}"`);
          }else{showError('Use apenas letras, n√∫meros e underscore (_)')}
        }
      });
    });

    function isValidInstanceName(name){return /^[a-zA-Z0-9_]+$/.test(name)}
    function showError(msg){const el=document.getElementById('errorMessage');el.textContent=msg;el.style.display='block';el.className='error-message'}
    function hideError(){const el=document.getElementById('errorMessage');el.style.display='none'}
    function formatInstanceName(name){return name.replace(/\s+/g,'_').toLowerCase()}

    async function generateQRCode(){
      const input=document.getElementById('instanceName');
      const instanceName=input.value.trim();
      hideError();
      if(!instanceName){showError('Por favor, insira o identificador da inst√¢ncia.');return;}
      if(!isValidInstanceName(instanceName)){
        if(instanceName.includes(' ')){const s=formatInstanceName(instanceName);showError(`Espa√ßos n√£o s√£o permitidos. Sugest√£o: "${s}"`);input.value=s;return;}
        else{showError('Identificador inv√°lido. Use apenas letras, n√∫meros e underscore (_).');return;}
      }
      const instanceStatus=await checkInstanceStatus(instanceName);
      if(instanceStatus.exists){
        if(instanceStatus.connected){
          showError(`A inst√¢ncia "${instanceName}" j√° existe e est√° conectada. Escolha outro identificador.`);return;
        }else{showInstanceExistsDialog(instanceName);return;}
      }else{await createNewInstance(instanceName);}
    }

    async function checkInstanceStatus(instanceName){
      try{
        const response=await fetch(WEBHOOK_STATUS_INSTANCIA,{
          method:'POST',headers:{'Content-Type':'application/json'},
          body:JSON.stringify({instanceName})
        });
        if(response.ok){
          const data=await response.json();
          let exists=false,connected=false;
          if(Array.isArray(data)&&data.length>0){
            const d=data[0];
            if(d.instance && d.instance.instanceName===instanceName){exists=true;if(d.instance.state==='open'){connected=true}}
          }else if(data.instance){
            if(data.instance.instanceName===instanceName){exists=true;if(data.instance.state==='open'){connected=true}}
          }else{
            exists=(data.connected===true || data.status==='connected' || data.state==='open');
          }
          return {exists,connected};
        }else{throw new Error('Erro ao verificar inst√¢ncia existente')}
      }catch(e){return {exists:false,connected:false}}
    }

    async function createNewInstance(instanceName){
      const loader=document.getElementById('loader');
      const btn=document.getElementById('generateButton');
      const qrcodeElement=document.getElementById('qrcode');
      loader.style.display='block';btn.disabled=true;qrcodeElement.innerHTML='';
      try{
        qrcodeElement.innerHTML=`
          <div class="status-message info">
            <div style="font-size:1.1rem;margin-bottom:.5rem;">üÜï</div>
            <div style="font-weight:700;margin-bottom:.5rem;">CRIANDO NOVA INST√ÇNCIA</div>
            <div style="font-size:.95rem;opacity:.9;">Identificador: "${instanceName}"</div>
            <div style="font-size:.85rem;opacity:.7;margin-top:.55rem;">Aguarde o QR Code...</div>
          </div>`;
        const response=await fetch(WEBHOOK_CRIAR,{
          method:'POST',headers:{'Content-Type':'application/json'},
          body:JSON.stringify({instanceName})
        });
        if(!response.ok) throw new Error('Erro ao criar nova inst√¢ncia');
        await processQRCodeResponse(response,qrcodeElement);
        currentInstanceName=instanceName;isConnected=false;startInstanceMonitoring();
      }catch(e){
        alert('Erro ao estabelecer conex√£o com o agente. Tente novamente.');
      }finally{loader.style.display='none';btn.disabled=false;}
    }

    async function processQRCodeResponse(response,qrcodeElement){
      const contentType=response.headers.get('content-type');
      let imgSrc;
      if(contentType && contentType.includes('application/json')){
        const data=await response.json();
        imgSrc=`data:image/png;base64,${data.qrCodeBase64}`;
      }else{
        const blob=await response.blob();
        imgSrc=URL.createObjectURL(blob);
      }
      qrcodeElement.innerHTML=`<img src="${imgSrc}" alt="QR Code de Conex√£o"/>`;
    }

    async function connectToExistingInstance(instanceName){
      const loader=document.getElementById('loader');
      const btn=document.getElementById('generateButton');
      const qrcodeElement=document.getElementById('qrcode');
      loader.style.display='block';btn.disabled=true;qrcodeElement.innerHTML='';
      try{
        qrcodeElement.innerHTML=`
          <div class="status-message info" style="border-color:rgba(167,139,250,.35);">
            <div style="color:#c4b5fd;font-size:.95rem;font-weight:700;">üîó Conectando √† inst√¢ncia "${instanceName}"...</div>
          </div>`;
        const response=await fetch(WEBHOOK_ATUALIZAR_QRCODE,{
          method:'POST',headers:{'Content-Type':'application/json'},
          body:JSON.stringify({instanceName})
        });
        if(!response.ok) throw new Error('Erro ao conectar √† inst√¢ncia existente');
        await processQRCodeResponse(response,qrcodeElement);
        currentInstanceName=instanceName;isConnected=false;startInstanceMonitoring();
      }catch(e){
        alert('Erro ao estabelecer conex√£o com o agente. Tente novamente.');
      }finally{loader.style.display='none';btn.disabled=false;}
    }

    function startInstanceMonitoring(){
      clearInterval(timerInterval);clearInterval(connectionCheckInterval);
      timeLeft=30;updateTimer();timerInterval=setInterval(updateTimer,1000);
      connectionCheckInterval=setInterval(checkConnectionStatus,5000);
    }

    async function updateQRCode(){
      if(currentInstanceName && !isConnected){
        try{
          const response=await fetch(WEBHOOK_ATUALIZAR_QRCODE,{
            method:'POST',headers:{'Content-Type':'application/json'},
            body:JSON.stringify({instanceName:currentInstanceName})
          });
          if(response.ok){
            const qrcodeElement=document.getElementById('qrcode');
            await processQRCodeResponse(response,qrcodeElement);
          }
        }catch(e){}
      }
    }

    async function checkConnectionStatus(){
      if(!currentInstanceName || isConnected) return;
      try{
        const statusResponse=await fetch(WEBHOOK_STATUS_INSTANCIA,{
          method:'POST',headers:{'Content-Type':'application/json'},
          body:JSON.stringify({instanceName:currentInstanceName})
        });
        if(statusResponse.ok){
          const statusData=await statusResponse.json();
          let ok=false;
          if(Array.isArray(statusData)&&statusData.length>0){
            const d=statusData[0]; if(d.instance && d.instance.state==='open'){ok=true}
          }else if(statusData.instance){
            if(statusData.instance.state==='open'){ok=true}
          }else{
            ok=(statusData.connected===true || statusData.status==='connected' || statusData.state==='open');
          }
          if(ok){await handleInstanceConnected();}
        }
      }catch(e){}
    }

    async function handleInstanceConnected(){
      if(isConnected) return;
      isConnected=true;
      clearInterval(timerInterval);clearInterval(connectionCheckInterval);
      try{updateUIForConnectedState();}catch(_){}
      try{
        await fetch(WEBHOOK_MENSAGEM,{
          method:'POST',headers:{'Content-Type':'application/json'},
          body:JSON.stringify({instanceName:currentInstanceName,event:'instance_connected',status:'connected',timestamp:new Date().toISOString()})
        });
      }catch(_){}
    }

    function updateUIForConnectedState(){
      const timerElement=document.getElementById('timer');
      const statusBar=document.querySelector('.status-bar');
      const qrcodeElement=document.getElementById('qrcode');
      if(!statusBar || !qrcodeElement){throw new Error('Elementos DOM n√£o encontrados')}
      statusBar.innerHTML=`
        <div class="status-indicator" style="background: var(--status-success);"></div>
        <div class="status-text">
          <div class="status-line-1">CONEX√ÉO ESTABELECIDA</div>
          <div class="status-line-2">SISTEMA ATIVO</div>
        </div>`;
      statusBar.style.background='linear-gradient(180deg, rgba(16,185,129,.16), rgba(16,185,129,.08))';
      statusBar.style.borderColor='rgba(16,185,129,.35)';
      statusBar.style.color='var(--status-success)';

      qrcodeElement.innerHTML=`
        <div class="status-message success">
          <div style="font-size:2.4rem;margin-bottom:.8rem;">‚úì</div>
          <h3 style="margin-bottom:.5rem;font-size:1.15rem;font-weight:800;">CONEX√ÉO ESTABELECIDA</h3>
          <p style="font-size:.95rem;opacity:.9;margin-bottom:.45rem;">Inst√¢ncia "${currentInstanceName}" conectada com sucesso</p>
          <div style="font-size:.85rem;opacity:.8;">WhatsApp conectado e operacional</div>
        </div>`;

      if(timerElement){timerElement.style.display='none'}

      const btn=document.getElementById('generateButton');
      if(btn){
        btn.textContent='NOVA CONEX√ÉO';
        btn.style.background='linear-gradient(180deg, #10b981, #059669)';
        btn.style.borderColor='rgba(16,185,129,.5)';
        btn.style.color='#04130e';
        btn.onclick=()=>{resetForm()};
      }
    }

    function showInstanceExistsDialog(instanceName){
      const qrcodeElement=document.getElementById('qrcode');
      const btn=document.getElementById('generateButton');
      btn.disabled=true;
      qrcodeElement.innerHTML=`
        <div class="status-message info">
          <div style="font-size:2.1rem;margin-bottom:.8rem;">‚ÑπÔ∏è</div>
          <h3 style="margin-bottom:.9rem;font-size:1.15rem;font-weight:800;">INST√ÇNCIA J√Å EXISTE</h3>
          <p style="font-size:.95rem;margin-bottom:.8rem;opacity:.92;">A inst√¢ncia <strong>"${instanceName}"</strong> j√° existe mas n√£o est√° conectada.</p>
          <p style="font-size:.9rem;margin-bottom:1.1rem;opacity:.85;">O que voc√™ deseja fazer?</p>
          <div style="display:flex;gap:.8rem;justify-content:center;flex-wrap:wrap;">
            <button onclick="connectToExistingInstance('${instanceName}')" class="btn btn-primary" style="width:auto;margin:0;">üîó CONECTAR √Ä INST√ÇNCIA EXISTENTE</button>
            <button onclick="hideInstanceExistsDialog()" class="btn" style="width:auto;margin:0;">‚ùå ESCOLHER OUTRO NOME</button>
          </div>
          <div style="margin-top:.9rem;font-size:.82rem;opacity:.7;">Escolha uma das op√ß√µes acima</div>
        </div>`;
    }

    function hideInstanceExistsDialog(){
      const qrcodeElement=document.getElementById('qrcode');
      const btn=document.getElementById('generateButton');
      qrcodeElement.innerHTML='';btn.disabled=false;showError('Escolha outro identificador para a inst√¢ncia.');
    }

    window.marcarComoConectado=function(){ if(currentInstanceName && !isConnected){handleInstanceConnected()} }
    window.verificarStatus=function(){ checkConnectionStatus() }
    window.resetarEstado=function(){ isConnected=false;currentInstanceName='';clearInterval(timerInterval);clearInterval(connectionCheckInterval) }

    function updateTimer(){
      const el=document.getElementById('timer');
      if(isConnected) return;
      el.textContent=`ATUALIZA√á√ÉO AUTOM√ÅTICA: ${timeLeft}s`;
      if(timeLeft===0){clearInterval(timerInterval);updateQRCode();timeLeft=30;timerInterval=setInterval(updateTimer,1000)}
      else{timeLeft--}
    }

    function resetForm(){
      const input=document.getElementById('instanceName');
      const qrcodeElement=document.getElementById('qrcode');
      const timerElement=document.getElementById('timer');
      const statusBar=document.querySelector('.status-bar');
      input.value='';hideError();
      qrcodeElement.innerHTML='';
      if(timerElement){timerElement.style.display='block';timerElement.textContent=''}
      if(statusBar){
        statusBar.innerHTML=`
          <div class="status-indicator"></div>
          <div class="status-text">
            <div class="status-line-1">SISTEMA OPERACIONAL</div>
            <div class="status-line-2">AGUARDANDO IDENTIFICA√á√ÉO</div>
          </div>`;
        statusBar.style.background='linear-gradient(180deg, rgba(27,19,49,.75), rgba(22,16,40,.75))';
        statusBar.style.borderColor='var(--border-secondary)';
        statusBar.style.color='#e9d5ff';
      }
      isConnected=false;currentInstanceName='';clearInterval(timerInterval);clearInterval(connectionCheckInterval);
      const btn=document.getElementById('generateButton');
      if(btn){
        btn.disabled=false;btn.textContent='GERAR QR CODE';
        btn.style.background='linear-gradient(180deg, #7c3aed, #5b21b6)';
        btn.style.borderColor='#a78bfa';btn.style.color='#fdfcff';
        btn.onclick=generateQRCode;
      }
    }
  </script>
</body>
</html>
